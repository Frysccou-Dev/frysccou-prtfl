---
import { getTranslation } from '../../utils/i18n';
const { lang } = Astro.props;

interface Project {
  id: string;
  titleKey: string;
  subtitleKey: string;
  descKey: string;
  featuresKey: string;
  featureKeys: string[];
  image: string;
  urlKey: string;
  gradient: string;
  techKey: string;
}

const projects: Project[] = [
  {
    id: 'liz',
    titleKey: 'projects.liz.title',
    subtitleKey: 'projects.liz.subtitle',
    descKey: 'projects.liz.description',
    featuresKey: 'projects.liz.features',
    featureKeys: [
      'projects.liz.feature1',
      'projects.liz.feature2',
      'projects.liz.feature3',
      'projects.liz.feature4',
    ],
    image: '/projects/liz.png',
    urlKey: 'projects.liz.url',
    gradient: 'from-pink-600 to-rose-800',
    techKey: 'projects.liz.tech',
  },
  {
    id: 'zatobox',
    titleKey: 'projects.zatobox.title',
    subtitleKey: 'projects.zatobox.subtitle',
    descKey: 'projects.zatobox.description',
    featuresKey: 'projects.zatobox.features',
    featureKeys: [
      'projects.zatobox.feature1',
      'projects.zatobox.feature2',
      'projects.zatobox.feature3',
      'projects.zatobox.feature4',
    ],
    image: '/projects/zatobox.png',
    urlKey: 'projects.zatobox.url',
    gradient: 'from-cyan-600 to-blue-800',
    techKey: 'projects.zatobox.tech',
  },
  {
    id: 'portfolio',
    titleKey: 'projects.portfolio.title',
    subtitleKey: 'projects.portfolio.subtitle',
    descKey: 'projects.portfolio.description',
    featuresKey: 'projects.portfolio.features',
    featureKeys: [
      'projects.portfolio.feature1',
      'projects.portfolio.feature2',
      'projects.portfolio.feature3',
      'projects.portfolio.feature4',
    ],
    image: '/projects/portfolio.png',
    urlKey: 'projects.portfolio.url',
    gradient: 'from-purple-600 to-purple-800',
    techKey: 'projects.portfolio.tech',
  },
  {
    id: 'gymMaster',
    titleKey: 'projects.gymMaster.title',
    subtitleKey: 'projects.gymMaster.subtitle',
    descKey: 'projects.gymMaster.description',
    featuresKey: 'projects.gymMaster.features',
    featureKeys: [
      'projects.gymMaster.feature1',
      'projects.gymMaster.feature2',
      'projects.gymMaster.feature3',
      'projects.gymMaster.feature4',
    ],
    image: '/projects/gym-master.jpg',
    urlKey: 'projects.gymMaster.url',
    gradient: 'from-rose-600 to-red-800',
    techKey: 'projects.gymMaster.tech',
  },
  {
    id: 'zzyn',
    titleKey: 'projects.zzyn.title',
    subtitleKey: 'projects.zzyn.subtitle',
    descKey: 'projects.zzyn.description',
    featuresKey: 'projects.zzyn.features',
    featureKeys: [
      'projects.zzyn.feature1',
      'projects.zzyn.feature2',
      'projects.zzyn.feature3',
      'projects.zzyn.feature4',
    ],
    image: '/projects/zzyn.png',
    urlKey: 'projects.zzyn.url',
    gradient: 'from-amber-600 to-orange-800',
    techKey: 'projects.zzyn.tech',
  },
  {
    id: 'bycarket',
    titleKey: 'projects.bycarket.title',
    subtitleKey: 'projects.bycarket.subtitle',
    descKey: 'projects.bycarket.description',
    featuresKey: 'projects.bycarket.features',
    featureKeys: [
      'projects.bycarket.feature1',
      'projects.bycarket.feature2',
      'projects.bycarket.feature3',
      'projects.bycarket.feature4',
    ],
    image: '/projects/bycarket.jpg',
    urlKey: 'projects.bycarket.url',
    gradient: 'from-blue-600 to-indigo-800',
    techKey: 'projects.bycarket.tech',
  },
  {
    id: 'xview',
    titleKey: 'projects.xview.title',
    subtitleKey: 'projects.xview.subtitle',
    descKey: 'projects.xview.description',
    featuresKey: 'projects.xview.features',
    featureKeys: [
      'projects.xview.feature1',
      'projects.xview.feature2',
      'projects.xview.feature3',
      'projects.xview.feature4',
    ],
    image: '/projects/xview.jpg',
    urlKey: 'projects.xview.url',
    gradient: 'from-indigo-600 to-purple-800',
    techKey: 'projects.xview.tech',
  },
  {
    id: 'zynner',
    titleKey: 'projects.zynner.title',
    subtitleKey: 'projects.zynner.subtitle',
    descKey: 'projects.zynner.description',
    featuresKey: 'projects.zynner.features',
    featureKeys: [
      'projects.zynner.feature1',
      'projects.zynner.feature2',
      'projects.zynner.feature3',
      'projects.zynner.feature4',
    ],
    image: '/projects/zynner-solutions.png',
    urlKey: 'projects.zynner.url',
    gradient: 'from-emerald-600 to-emerald-800',
    techKey: 'projects.zynner.tech',
  },
  {
    id: 'zynee',
    titleKey: 'projects.zynee.title',
    subtitleKey: 'projects.zynee.subtitle',
    descKey: 'projects.zynee.description',
    featuresKey: 'projects.zynee.features',
    featureKeys: [
      'projects.zynee.feature1',
      'projects.zynee.feature2',
      'projects.zynee.feature3',
      'projects.zynee.feature4',
    ],
    image: '/projects/zynee.png',
    urlKey: 'projects.zynee.url',
    gradient: 'from-teal-600 to-cyan-800',
    techKey: 'projects.zynee.tech',
  },
];

const techData: Record<string, Record<string, string[]>> = {
  en: {
    'projects.portfolio.tech': ['Astro', 'TailwindCSS', 'i18n', 'TypeScript'],
    'projects.gymMaster.tech': [
      'Next.js',
      'TailwindCSS',
      'Shadcn UI',
      'Supabase',
    ],
    'projects.zatobox.tech': [
      'Full Stack',
      'DevOps',
      'Cloud Architecture',
      'Scalability',
    ],
    'projects.zzyn.tech': [
      'Nuxt.js',
      'Framer Motion',
      'TailwindCSS',
      'TypeScript',
    ],
    'projects.bycarket.tech': [
      'Next.js',
      'Nest.js',
      'AI Integration',
      'Stripe',
    ],
    'projects.xview.tech': [
      'React',
      'Glassmorphism',
      'Framer Motion',
      'JWT Auth',
    ],
    'projects.zynner.tech': [
      'Modern Web',
      'Responsive Design',
      'Portfolio',
      'Professional',
    ],
    'projects.zynee.tech': [
      'Financial App',
      'Real-time Data',
      'Secure Architecture',
      'Analytics',
    ],
    'projects.liz.tech': ['Vue 3', 'Supabase', 'AniList API', 'GSAP'],
  },
  es: {
    'projects.portfolio.tech': ['Astro', 'TailwindCSS', 'i18n', 'TypeScript'],
    'projects.gymMaster.tech': [
      'Next.js',
      'TailwindCSS',
      'Shadcn UI',
      'Supabase',
    ],
    'projects.zatobox.tech': [
      'Full Stack',
      'DevOps',
      'Cloud Architecture',
      'Escalabilidad',
    ],
    'projects.zzyn.tech': [
      'Nuxt.js',
      'Framer Motion',
      'TailwindCSS',
      'TypeScript',
    ],
    'projects.bycarket.tech': [
      'Next.js',
      'Nest.js',
      'AI Integration',
      'Stripe',
    ],
    'projects.xview.tech': [
      'React',
      'Glassmorphism',
      'Framer Motion',
      'JWT Auth',
    ],
    'projects.zynner.tech': [
      'Web Moderno',
      'Diseño Responsive',
      'Portfolio',
      'Profesional',
    ],
    'projects.zynee.tech': [
      'App Financiera',
      'Datos en Tiempo Real',
      'Arquitectura Segura',
      'Análisis',
    ],
    'projects.liz.tech': ['Vue 3', 'Supabase', 'AniList API', 'GSAP'],
  },
};

const urlData: Record<string, string> = {
  'projects.portfolio.url': 'https://frysccou-dev.vercel.app/',
  'projects.gymMaster.url': 'https://gym-master-new.vercel.app',
  'projects.zatobox.url': 'https://zatobox.io/',
  'projects.zzyn.url': 'https://zzyn.vercel.app/',
  'projects.bycarket.url': 'https://bycarket-front-main.vercel.app/home',
  'projects.xview.url': 'https://xview.vercel.app/',
  'projects.zynner.url': 'https://zynner-portfolio.vercel.app/',
  'projects.zynee.url': 'https://zynee.vercel.app/',
  'projects.liz.url': 'https://liz-beth.vercel.app/',
};

const repoData: Record<string, string> = {
  'projects.portfolio.repo': 'https://github.com/Frysccou-Dev/frysccou-prtfl',
  'projects.zatobox.repo': 'https://github.com/ZatoBox/main',
  'projects.gymMaster.repo': 'https://github.com/Dragon-Pyramid/gym-master',
  'projects.liz.repo': 'https://github.com/Frysccou-Dev/liz',
  'projects.zynner.repo':
    'https://github.com/Zynner-Solutions/zynner-portfolio',
  'projects.zzyn.repo': 'https://github.com/Frysccou-Dev/zzyn',
  'projects.xview.repo': 'https://github.com/Frysccou-Dev/Xview',
  'projects.zynee.repo': 'https://github.com/Zynner-Solutions/Zynee',
  'projects.bycarket.repo': 'https://github.com/ByCarket/bycarket--front',
};

function getTech(key: string): string[] {
  return (techData[lang] as Record<string, string[]>)[key] || [];
}

function getUrl(key: string): string {
  return urlData[key] || '#';
}

function getRepo(id: string): string {
  return repoData[`projects.${id}.repo`] || '#';
}

function isLarge(index: number): boolean {
  return index % 3 === 0;
}
---

<section id='proyectos' class='min-h-screen py-24 relative'>
  <div class='max-w-[1600px] mx-auto px-6 sm:px-8 lg:px-12 relative z-10'>
    <div class='text-center mb-20'>
      <h2 class='text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6'>
        {getTranslation(lang, 'home.title')}
      </h2>
      <p class='text-lg text-blue-300 max-w-3xl mx-auto'>
        {getTranslation(lang, 'home.subtitle')}
      </p>
    </div>

    <div class='space-y-8'>
      {
        projects.map((project, index) => {
          const tech = getTech(project.techKey);
          const url = getUrl(project.urlKey);
          const repoUrl = getRepo(project.id);
          const large = isLarge(index);
          const isPremium = ['liz', 'zatobox'].includes(project.id);
          const isStartOfPair = index % 3 === 1;
          const isEndOfPair = index % 3 === 2;
          const nextProject = isStartOfPair ? projects[index + 1] : null;

          if (isEndOfPair) return null;

          if (large) {
            return (
              <div class='bg-dark-800 border border-dark-600 rounded-lg overflow-hidden shadow-lg hover:shadow-2xl hover:border-blue-600 transition-all duration-300'>
                <div class='grid grid-cols-1 lg:grid-cols-2'>
                  <div class='relative h-[300px] sm:h-[350px] lg:h-[450px] overflow-hidden'>
                    <img
                      src={project.image}
                      alt={`${project.id} project preview`}
                      class='w-full h-full object-cover object-top hover:scale-105 transition-transform duration-500'
                      loading='lazy'
                    />
                    {isPremium && (
                      <div class='absolute top-4 left-4 bg-blue-500 text-white text-xs font-bold px-3 py-1.5 rounded'>
                        PREMIUM
                      </div>
                    )}
                  </div>

                  <div class='p-8 lg:p-10 flex flex-col justify-center'>
                    <div class='mb-4'>
                      <h3 class='text-2xl sm:text-3xl font-bold text-white mb-2'>
                        {getTranslation(lang, project.titleKey)}
                      </h3>
                      <p class='text-sm font-semibold text-blue-400'>
                        {getTranslation(lang, project.subtitleKey)}
                      </p>
                    </div>

                    <p
                      class='text-dark-600 text-sm leading-relaxed mb-6'
                      style='color: #a1a1aa;'
                    >
                      {getTranslation(lang, project.descKey)}
                    </p>

                    <div class='mb-6'>
                      <h4 class='text-xs font-bold text-blue-300 uppercase tracking-wider mb-3'>
                        {getTranslation(lang, project.featuresKey)}
                      </h4>
                      <ul class='grid grid-cols-1 sm:grid-cols-2 gap-2'>
                        {project.featureKeys.map((featureKey) => (
                          <li
                            class='flex items-start gap-2 text-sm'
                            style='color: #a1a1aa;'
                          >
                            <svg
                              class='w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0'
                              fill='none'
                              stroke='currentColor'
                              viewBox='0 0 24 24'
                            >
                              <path
                                stroke-linecap='round'
                                stroke-linejoin='round'
                                stroke-width='2'
                                d='M5 13l4 4L19 7'
                              />
                            </svg>
                            <span>{getTranslation(lang, featureKey)}</span>
                          </li>
                        ))}
                      </ul>
                    </div>

                    <div class='flex flex-wrap gap-2 mb-6'>
                      {tech.map((t) => (
                        <span class='px-3 py-1 text-xs font-medium text-blue-300 bg-dark-700 border border-dark-600 rounded'>
                          {t}
                        </span>
                      ))}
                    </div>

                    <div class='flex flex-wrap gap-3'>
                      <a
                        href={url}
                        target='_blank'
                        rel='noopener noreferrer'
                        class='inline-flex items-center gap-2 bg-blue-500 text-white px-5 py-2.5 rounded font-medium text-sm hover:bg-blue-400 transition-colors duration-200'
                      >
                        {getTranslation(lang, 'home.viewLiveSite')}
                        <svg
                          class='w-4 h-4'
                          fill='none'
                          stroke='currentColor'
                          viewBox='0 0 24 24'
                        >
                          <path
                            stroke-linecap='round'
                            stroke-linejoin='round'
                            stroke-width='2'
                            d='M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14'
                          />
                        </svg>
                      </a>
                      {repoUrl !== '#' && (
                        <a
                          href={repoUrl}
                          target='_blank'
                          rel='noopener noreferrer'
                          class='inline-flex items-center gap-2 bg-dark-700 text-white px-5 py-2.5 rounded font-medium text-sm hover:bg-dark-600 border border-dark-600 transition-colors duration-200'
                        >
                          GitHub
                          <svg
                            class='w-4 h-4'
                            fill='currentColor'
                            viewBox='0 0 24 24'
                          >
                            <path
                              fill-rule='evenodd'
                              d='M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z'
                              clip-rule='evenodd'
                            />
                          </svg>
                        </a>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (isStartOfPair && nextProject) {
            const nextTech = getTech(nextProject.techKey);
            const nextUrl = getUrl(nextProject.urlKey);
            const nextRepoUrl = getRepo(nextProject.id);
            const nextIsPremium = ['liz', 'zatobox'].includes(nextProject.id);

            return (
              <div class='grid grid-cols-1 md:grid-cols-2 gap-8'>
                <div class='bg-dark-800 border border-dark-600 rounded-lg overflow-hidden shadow-lg hover:shadow-2xl hover:border-blue-600 transition-all duration-300'>
                  <div class='relative h-[220px] sm:h-[260px] overflow-hidden'>
                    <img
                      src={project.image}
                      alt={`${project.id} project preview`}
                      class='w-full h-full object-cover object-top hover:scale-105 transition-transform duration-500'
                      loading='lazy'
                    />
                    {isPremium && (
                      <div class='absolute top-4 left-4 bg-blue-500 text-white text-xs font-bold px-3 py-1.5 rounded'>
                        PREMIUM
                      </div>
                    )}
                  </div>

                  <div class='p-6'>
                    <div class='mb-3'>
                      <h3 class='text-xl font-bold text-white mb-1'>
                        {getTranslation(lang, project.titleKey)}
                      </h3>
                      <p class='text-xs font-semibold text-blue-400'>
                        {getTranslation(lang, project.subtitleKey)}
                      </p>
                    </div>

                    <p
                      class='text-sm leading-relaxed mb-4 line-clamp-3'
                      style='color: #a1a1aa;'
                    >
                      {getTranslation(lang, project.descKey)}
                    </p>

                    <div class='mb-4'>
                      <ul class='space-y-1.5'>
                        {project.featureKeys.slice(0, 2).map((featureKey) => (
                          <li
                            class='flex items-start gap-2 text-xs'
                            style='color: #a1a1aa;'
                          >
                            <svg
                              class='w-3.5 h-3.5 text-blue-400 mt-0.5 flex-shrink-0'
                              fill='none'
                              stroke='currentColor'
                              viewBox='0 0 24 24'
                            >
                              <path
                                stroke-linecap='round'
                                stroke-linejoin='round'
                                stroke-width='2'
                                d='M5 13l4 4L19 7'
                              />
                            </svg>
                            <span>{getTranslation(lang, featureKey)}</span>
                          </li>
                        ))}
                      </ul>
                    </div>

                    <div class='flex flex-wrap gap-1.5 mb-5'>
                      {tech.slice(0, 4).map((t) => (
                        <span class='px-2 py-0.5 text-xs font-medium text-blue-300 bg-dark-700 border border-dark-600 rounded'>
                          {t}
                        </span>
                      ))}
                    </div>

                    <div class='flex gap-2'>
                      <a
                        href={url}
                        target='_blank'
                        rel='noopener noreferrer'
                        class='inline-flex items-center gap-1.5 bg-blue-500 text-white px-4 py-2 rounded font-medium text-xs hover:bg-blue-400 transition-colors duration-200'
                      >
                        {getTranslation(lang, 'home.viewLiveSite')}
                        <svg
                          class='w-3.5 h-3.5'
                          fill='none'
                          stroke='currentColor'
                          viewBox='0 0 24 24'
                        >
                          <path
                            stroke-linecap='round'
                            stroke-linejoin='round'
                            stroke-width='2'
                            d='M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14'
                          />
                        </svg>
                      </a>
                      {repoUrl !== '#' && (
                        <a
                          href={repoUrl}
                          target='_blank'
                          rel='noopener noreferrer'
                          class='inline-flex items-center gap-1.5 bg-dark-700 text-white px-4 py-2 rounded font-medium text-xs hover:bg-dark-600 border border-dark-600 transition-colors duration-200'
                        >
                          GitHub
                        </a>
                      )}
                    </div>
                  </div>
                </div>

                <div class='bg-dark-800 border border-dark-600 rounded-lg overflow-hidden shadow-lg hover:shadow-2xl hover:border-blue-600 transition-all duration-300'>
                  <div class='relative h-[220px] sm:h-[260px] overflow-hidden'>
                    <img
                      src={nextProject.image}
                      alt={`${nextProject.id} project preview`}
                      class='w-full h-full object-cover object-top hover:scale-105 transition-transform duration-500'
                      loading='lazy'
                    />
                    {nextIsPremium && (
                      <div class='absolute top-4 left-4 bg-blue-500 text-white text-xs font-bold px-3 py-1.5 rounded'>
                        PREMIUM
                      </div>
                    )}
                  </div>

                  <div class='p-6'>
                    <div class='mb-3'>
                      <h3 class='text-xl font-bold text-white mb-1'>
                        {getTranslation(lang, nextProject.titleKey)}
                      </h3>
                      <p class='text-xs font-semibold text-blue-400'>
                        {getTranslation(lang, nextProject.subtitleKey)}
                      </p>
                    </div>

                    <p
                      class='text-sm leading-relaxed mb-4 line-clamp-3'
                      style='color: #a1a1aa;'
                    >
                      {getTranslation(lang, nextProject.descKey)}
                    </p>

                    <div class='mb-4'>
                      <ul class='space-y-1.5'>
                        {nextProject.featureKeys
                          .slice(0, 2)
                          .map((featureKey) => (
                            <li
                              class='flex items-start gap-2 text-xs'
                              style='color: #a1a1aa;'
                            >
                              <svg
                                class='w-3.5 h-3.5 text-blue-400 mt-0.5 flex-shrink-0'
                                fill='none'
                                stroke='currentColor'
                                viewBox='0 0 24 24'
                              >
                                <path
                                  stroke-linecap='round'
                                  stroke-linejoin='round'
                                  stroke-width='2'
                                  d='M5 13l4 4L19 7'
                                />
                              </svg>
                              <span>{getTranslation(lang, featureKey)}</span>
                            </li>
                          ))}
                      </ul>
                    </div>

                    <div class='flex flex-wrap gap-1.5 mb-5'>
                      {nextTech.slice(0, 4).map((t) => (
                        <span class='px-2 py-0.5 text-xs font-medium text-blue-300 bg-dark-700 border border-dark-600 rounded'>
                          {t}
                        </span>
                      ))}
                    </div>

                    <div class='flex gap-2'>
                      <a
                        href={nextUrl}
                        target='_blank'
                        rel='noopener noreferrer'
                        class='inline-flex items-center gap-1.5 bg-blue-500 text-white px-4 py-2 rounded font-medium text-xs hover:bg-blue-400 transition-colors duration-200'
                      >
                        {getTranslation(lang, 'home.viewLiveSite')}
                        <svg
                          class='w-3.5 h-3.5'
                          fill='none'
                          stroke='currentColor'
                          viewBox='0 0 24 24'
                        >
                          <path
                            stroke-linecap='round'
                            stroke-linejoin='round'
                            stroke-width='2'
                            d='M10 6H6a2 2 0 00-2 2v10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14'
                          />
                        </svg>
                      </a>
                      {nextRepoUrl !== '#' && (
                        <a
                          href={nextRepoUrl}
                          target='_blank'
                          rel='noopener noreferrer'
                          class='inline-flex items-center gap-1.5 bg-dark-700 text-white px-4 py-2 rounded font-medium text-xs hover:bg-dark-600 border border-dark-600 transition-colors duration-200'
                        >
                          GitHub
                        </a>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          return null;
        })
      }
    </div>
  </div>
</section>
