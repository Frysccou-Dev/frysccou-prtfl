<div
  id="custom-cursor"
  class="custom-cursor pointer-events-none fixed top-0 left-0 z-9999 opacity-0"
>
  <div class="w-2 h-2 bg-accent rounded-full transition-transform duration-300">
  </div>
</div>

<div
  id="cursor-trail-1"
  class="cursor-trail pointer-events-none fixed top-0 left-0 z-9998 opacity-0"
>
  <div class="w-1.5 h-1.5 bg-accent rounded-full opacity-60"></div>
</div>

<div
  id="cursor-trail-2"
  class="cursor-trail pointer-events-none fixed top-0 left-0 z-9997 opacity-0"
>
  <div class="w-1 h-1 bg-accent rounded-full opacity-40"></div>
</div>

<div
  id="cursor-trail-3"
  class="cursor-trail pointer-events-none fixed top-0 left-0 z-9996 opacity-0"
>
  <div class="w-1 h-1 bg-accent rounded-full opacity-20"></div>
</div>

<style>
  .custom-cursor,
  .cursor-trail {
    transition: opacity 0.3s ease;
    will-change: transform;
    pointer-events: none;
  }

  @media (hover: none) and (pointer: coarse) {
    #custom-cursor,
    .cursor-trail {
      display: none !important;
    }
  }

  @media (hover: hover) and (pointer: fine) {
    #custom-cursor,
    .cursor-trail {
      display: block;
    }
  }

  .cursor-active div {
    transform: scale(2);
  }
</style>

<script>
  import gsap from "gsap";

  const cursor = document.getElementById("custom-cursor");
  const trail1 = document.getElementById("cursor-trail-1");
  const trail2 = document.getElementById("cursor-trail-2");
  const trail3 = document.getElementById("cursor-trail-3");

  let hasMouseMoved = false;

  if (
    cursor &&
    window.matchMedia("(hover: hover) and (pointer: fine)").matches
  ) {
    window.addEventListener("mousemove", (e) => {
      if (!hasMouseMoved) {
        cursor.style.opacity = "1";
        trail1!.style.opacity = "1";
        trail2!.style.opacity = "1";
        trail3!.style.opacity = "1";
        hasMouseMoved = true;
      }

      gsap.to(cursor, {
        x: e.clientX,
        y: e.clientY,
        duration: 0.15,
        ease: "power2.out",
      });

      gsap.to(trail1, {
        x: e.clientX,
        y: e.clientY,
        duration: 0.25,
        ease: "power2.out",
      });

      gsap.to(trail2, {
        x: e.clientX,
        y: e.clientY,
        duration: 0.35,
        ease: "power2.out",
      });

      gsap.to(trail3, {
        x: e.clientX,
        y: e.clientY,
        duration: 0.45,
        ease: "power2.out",
      });
    });

    const clickables = document.querySelectorAll('a, button, [role="button"]');

    clickables.forEach((el) => {
      el.addEventListener("mouseenter", () => {
        cursor.classList.add("cursor-active");
      });
      el.addEventListener("mouseleave", () => {
        cursor.classList.remove("cursor-active");
      });
    });
  }
</script>
