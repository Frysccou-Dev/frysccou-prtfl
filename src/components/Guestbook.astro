---
import { translations } from "../i18n/translations.js";
import { BookHeart } from "lucide-astro";
import GuestbookList from "./guestbook/GuestbookList.tsx";
import GuestbookForm from "./guestbook/GuestbookForm";

const t = translations.en;
---

<section id="guestbook" class="py-16 relative overflow-hidden">
  <div class="max-w-6xl mx-auto px-6 relative z-10">
    <div class="guestbook-container opacity-0 translate-y-10">
      <div class="text-center mb-12">
        <div
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-accent-soft/30 border border-accent/20 mb-4"
        >
          <BookHeart class="w-4 h-4 text-accent" />
          <span
            class="text-xs font-bold text-accent uppercase tracking-widest"
            data-i18n="guestbook.badge">{t.guestbook.badge}</span
          >
        </div>
        <h2
          class="text-3xl md:text-4xl font-[Outfit] font-bold text-text-primary mb-3"
          data-i18n="guestbook.title"
        >
          {t.guestbook.title}
        </h2>
        <p
          class="text-text-muted text-sm md:text-base"
          data-i18n="guestbook.subtitle"
        >
          {t.guestbook.subtitle}
        </p>
      </div>

      <div class="grid md:grid-cols-2 gap-8">
        <div class="order-2 md:order-1">
          <h3
            class="text-lg font-bold text-text-primary mb-4 flex items-center gap-2"
            data-i18n="guestbook.messagesTitle"
          >
            <span class="w-1.5 h-1.5 rounded-full bg-accent animate-pulse"
            ></span>
            {t.guestbook.messagesTitle}
          </h3>
          <GuestbookList client:load translations={t.guestbook} />
        </div>

        <div class="order-1 md:order-2">
          <div
            class="sticky top-24 p-px rounded-3xl bg-linear-to-r from-accent/20 to-rose-accent/20 transition-all duration-500 hover:shadow-2xl hover:shadow-accent/10"
          >
            <div
              class="bg-white/80 backdrop-blur-xl rounded-[calc(1.5rem-1px)] p-6 md:p-8 border border-white"
            >
              <GuestbookForm client:load translations={t.guestbook} />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    gsap.to(".guestbook-container", {
      scrollTrigger: {
        trigger: "#guestbook",
        start: "top 85%",
      },
      opacity: 1,
      y: 0,
      duration: 1,
      ease: "power3.out",
    });
  });
</script>
